<div class="report-form-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="left-section">
        <div class="template-name">
          <span class="template-label">{{ isEditMode() ? 'Edit' : 'Create' }} Custom Template</span>
        </div>
      </div>
      <div class="header-info">
        <h1 class="page-title">Custom Template for {{ bankCode() }} - {{ propertyType() }}</h1>
      </div>
      <div class="right-section">
        <button class="back-button" (click)="goBack()">
          ‚Üê Back
        </button>
      </div>
    </div>
  </div>

  <!-- Error Display -->
  <div *ngIf="error()" class="alert alert-error">
    {{ error() }}
  </div>

  <!-- Loading indicator -->
  <div *ngIf="isLoading()" class="loading-indicator">
    <div class="loading-spinner"></div>
    <p>Loading template fields: {{ bankCode() }}/{{ propertyType() }}-property...</p>
    <small>Fetching all fields from server</small>
  </div>

  <!-- Form Content -->
  <div class="report-form" *ngIf="!isLoading()">
    
    <!-- Template Metadata Section -->
    <form [formGroup]="mainForm" class="metadata-form">
      <div class="form-section">
        <div class="section-header">
          <h2 class="section-title">Template Information</h2>
          <p class="section-subtitle">Basic details for your custom template</p>
        </div>
        
        <div class="fields-grid">
          <div class="field-container grid-4">
            <div class="form-field">
              <label for="templateName" class="field-label">
                Template Name
                <span class="required-indicator">*</span>
              </label>
              <input
                id="templateName"
                type="text"
                formControlName="templateName"
                placeholder="Enter template name"
                class="form-input"
                [class.error]="mainForm.get('templateName')?.invalid && mainForm.get('templateName')?.touched"
              />
              <div class="field-error" *ngIf="mainForm.get('templateName')?.invalid && mainForm.get('templateName')?.touched">
                <span *ngIf="mainForm.get('templateName')?.errors?.['required']">Template name is required</span>
                <span *ngIf="mainForm.get('templateName')?.errors?.['minlength']">Template name must be at least 3 characters</span>
              </div>
            </div>
          </div>
          <div class="field-container grid-8">
            <div class="form-field">
              <label for="description" class="field-label">Description</label>
              <textarea
                id="description"
                formControlName="description"
                placeholder="Enter template description"
                class="form-textarea"
                rows="3"
              ></textarea>
            </div>
          </div>
        </div>
      </div>
    </form>

    <!-- All Fields Section - Simple List -->
    <form [formGroup]="fieldsForm" class="fields-form" *ngIf="isFormReady()">
      <div class="form-section">
        <div class="section-header">
          <h2 class="section-title">Template Fields</h2>
          <p class="section-subtitle">All available fields for {{ bankCode() }} - {{ propertyType() }} template</p>
        </div>
        
        <!-- Fields organized by Tabs and Sections like New Report -->
        <div class="compact-field-groups">
          <ng-container *ngFor="let tab of getBankSpecificTabs()">
            <div class="field-group">
              <!-- Tab Title (if multiple tabs) -->
              <h3 *ngIf="getBankSpecificTabs().length > 1" class="tab-group-title">
                {{ tab.tabName }}
              </h3>

              <!-- Tab-level fields (if no sections) -->
              <div *ngIf="!tabHasSections(tab)" class="fields-grid">
                <div *ngFor="let field of tab.fields" 
                     [class]="'field-container grid-' + field.gridSize"
                     [class.field-error]="isFieldInvalid(field.fieldId)">
                
                <!-- Field rendering -->
                <ng-container [ngSwitch]="field.fieldType">
                  <!-- Text Input -->
                  <div *ngSwitchCase="'text'" class="form-field">
                    <label [for]="field.fieldId" class="field-label">
                      {{ field.uiDisplayName }}
                      <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                      <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                    </label>
                    <input
                      [id]="field.fieldId"
                      type="text"
                      [formControlName]="field.fieldId"
                      [placeholder]="field.placeholder"
                      [readonly]="!isFieldEditable(field)"
                      [class.readonly-field]="!isFieldEditable(field)"
                      class="form-input"
                    />
                    <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                  </div>

                  <!-- Date Input -->
                  <div *ngSwitchCase="'date'" class="form-field">
                    <label [for]="field.fieldId" class="field-label">
                      {{ field.uiDisplayName }}
                      <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                      <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                    </label>
                    <input
                      [id]="field.fieldId"
                      type="date"
                      [formControlName]="field.fieldId"
                      [readonly]="!isFieldEditable(field)"
                      [class.readonly-field]="!isFieldEditable(field)"
                      class="form-input"
                    />
                    <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                  </div>

                  <!-- Number/Currency Input -->
                  <div *ngSwitchCase="'number'" class="form-field">
                    <label [for]="field.fieldId" class="field-label">
                      {{ field.uiDisplayName }}
                      <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                      <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                    </label>
                    <input
                      [id]="field.fieldId"
                      type="number"
                      [formControlName]="field.fieldId"
                      [placeholder]="field.placeholder"
                      [min]="field.validation?.min || null"
                      [max]="field.validation?.max || null"
                      [readonly]="!isFieldEditable(field)"
                      [class.readonly-field]="!isFieldEditable(field)"
                      class="form-input"
                    />
                    <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                  </div>

                  <!-- Currency Input -->
                  <div *ngSwitchCase="'currency'" class="form-field">
                    <label [for]="field.fieldId" class="field-label">
                      {{ field.uiDisplayName }}
                      <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                      <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                    </label>
                    <input
                      [id]="field.fieldId"
                      type="number"
                      [formControlName]="field.fieldId"
                      [placeholder]="field.placeholder"
                      [min]="field.validation?.min || null"
                      [max]="field.validation?.max || null"
                      [readonly]="!isFieldEditable(field)"
                      [class.readonly-field]="!isFieldEditable(field)"
                      class="form-input"
                    />
                    <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                  </div>

                  <!-- Textarea Input -->
                  <div *ngSwitchCase="'textarea'" class="form-field">
                    <label [for]="field.fieldId" class="field-label">
                      {{ field.uiDisplayName }}
                      <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                      <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                    </label>
                    <textarea
                      [id]="field.fieldId"
                      [formControlName]="field.fieldId"
                      [placeholder]="field.placeholder"
                      [readonly]="!isFieldEditable(field)"
                      [class.readonly-field]="!isFieldEditable(field)"
                      class="form-textarea"
                      rows="3"
                    ></textarea>
                    <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                  </div>

                  <!-- Group Field with SubFields -->
                  <div *ngSwitchCase="'group'" class="form-field field-group">
                    <div class="group-header">
                      <label class="field-label group-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      </label>
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>
                    <div class="group-fields">
                      <ng-container *ngFor="let subField of field.subFields">
                        <div class="subfield-container" [class]="'grid-' + (subField.gridSize || 3)">
                          <ng-container [ngSwitch]="subField.fieldType">
                            <!-- SubField Text Input -->
                            <div *ngSwitchCase="'text'" class="form-field">
                              <label [for]="subField.fieldId" class="field-label">
                                {{ subField.uiDisplayName }}
                                <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                              </label>
                              <input
                                [id]="subField.fieldId"
                                type="text"
                                [formControlName]="subField.fieldId"
                                [placeholder]="subField.placeholder"
                                [readonly]="!isFieldEditable(subField)"
                                class="form-input"
                              />
                            </div>

                            <!-- SubField Number Input -->
                            <div *ngSwitchCase="'number'" class="form-field">
                              <label [for]="subField.fieldId" class="field-label">
                                {{ subField.uiDisplayName }}
                                <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                              </label>
                              <input
                                [id]="subField.fieldId"
                                type="number"
                                [formControlName]="subField.fieldId"
                                [placeholder]="subField.placeholder"
                                [readonly]="!isFieldEditable(subField)"
                                class="form-input"
                              />
                            </div>

                            <!-- SubField Select -->
                            <div *ngSwitchCase="'select'" class="form-field">
                              <label [for]="subField.fieldId" class="field-label">
                                {{ subField.uiDisplayName }}
                                <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                              </label>
                              <select 
                                [id]="subField.fieldId"
                                [formControlName]="subField.fieldId"
                                [disabled]="!isFieldEditable(subField)"
                                class="form-select">
                                <option value="" hidden>{{ subField.placeholder || 'Select option' }}</option>
                                <option *ngFor="let option of subField.options" [value]="option.value">
                                  {{ option.label }}
                                </option>
                              </select>
                            </div>

                            <!-- SubField Textarea -->
                            <div *ngSwitchCase="'textarea'" class="form-field">
                              <label [for]="subField.fieldId" class="field-label">
                                {{ subField.uiDisplayName }}
                                <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                              </label>
                              <textarea
                                [id]="subField.fieldId"
                                [formControlName]="subField.fieldId"
                                [placeholder]="subField.placeholder"
                                [readonly]="!isFieldEditable(subField)"
                                class="form-textarea"
                                rows="2"
                              ></textarea>
                            </div>

                            <!-- SubField Default -->
                            <div *ngSwitchDefault class="form-field">
                              <label [for]="subField.fieldId" class="field-label">
                                {{ subField.uiDisplayName }}
                                <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                              </label>
                              <input
                                [id]="subField.fieldId"
                                type="text"
                                [formControlName]="subField.fieldId"
                                [placeholder]="subField.placeholder"
                                [readonly]="!isFieldEditable(subField)"
                                class="form-input"
                              />
                            </div>
                          </ng-container>
                        </div>
                      </ng-container>
                    </div>
                  </div>

                  <!-- Select Input -->
                  <div *ngSwitchCase="'select'" class="form-field">
                    <label [for]="field.fieldId" class="field-label">
                      {{ field.uiDisplayName }}
                      <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                      <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                    </label>
                    <select 
                      [id]="field.fieldId"
                      [formControlName]="field.fieldId"
                      [disabled]="!isFieldEditable(field)"
                      class="form-select">
                      <option value="" hidden>{{ field.placeholder || 'Select option' }}</option>
                      <option *ngFor="let option of field.options" [value]="option.value">
                        {{ option.label }}
                      </option>
                    </select>
                    <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                  </div>

                  <!-- Default case for other field types -->
                  <div *ngSwitchDefault class="form-field">
                    <label [for]="field.fieldId" class="field-label">
                      {{ field.uiDisplayName }}
                      <span class="required-indicator" *ngIf="field.isRequired">*</span>
                      <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                      <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                    </label>
                    <input
                      [id]="field.fieldId"
                      type="text"
                      [formControlName]="field.fieldId"
                      [placeholder]="field.placeholder"
                      [readonly]="!isFieldEditable(field)"
                      [class.readonly-field]="!isFieldEditable(field)"
                      class="form-input"
                    />
                    <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                  </div>
                </ng-container>
              </div>
              </div>

              <!-- Section fields with section titles -->
              <div *ngIf="tabHasSections(tab)">
                <div *ngFor="let section of getTabSections(tab)" class="valuation-section">
                  <h4 class="section-title">{{ section.sectionName }}</h4>
                  <div class="fields-grid">
                    <div *ngFor="let field of section.fields" 
                         [class]="'field-container grid-' + field.gridSize"
                         [class.field-error]="isFieldInvalid(field.fieldId)">
                  
                      <!-- Field rendering -->
                  <ng-container [ngSwitch]="field.fieldType">
                    <!-- Text Input -->
                    <div *ngSwitchCase="'text'" class="form-field">
                      <label [for]="field.fieldId" class="field-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                        <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                      </label>
                      <input
                        [id]="field.fieldId"
                        type="text"
                        [formControlName]="field.fieldId"
                        [placeholder]="field.placeholder"
                        [readonly]="!isFieldEditable(field)"
                        [class.readonly-field]="!isFieldEditable(field)"
                        class="form-input"
                      />
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>

                    <!-- Date Input -->
                    <div *ngSwitchCase="'date'" class="form-field">
                      <label [for]="field.fieldId" class="field-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                        <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                      </label>
                      <input
                        [id]="field.fieldId"
                        type="date"
                        [formControlName]="field.fieldId"
                        [readonly]="!isFieldEditable(field)"
                        [class.readonly-field]="!isFieldEditable(field)"
                        class="form-input"
                      />
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>

                    <!-- Number/Currency Input -->
                    <div *ngSwitchCase="'number'" class="form-field">
                      <label [for]="field.fieldId" class="field-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                        <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                      </label>
                      <input
                        [id]="field.fieldId"
                        type="number"
                        [formControlName]="field.fieldId"
                        [placeholder]="field.placeholder"
                        [min]="field.validation?.min || null"
                        [max]="field.validation?.max || null"
                        [readonly]="!isFieldEditable(field)"
                        [class.readonly-field]="!isFieldEditable(field)"
                        class="form-input"
                      />
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>

                    <!-- Currency Input -->
                    <div *ngSwitchCase="'currency'" class="form-field">
                      <label [for]="field.fieldId" class="field-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                        <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                      </label>
                      <input
                        [id]="field.fieldId"
                        type="number"
                        [formControlName]="field.fieldId"
                        [placeholder]="field.placeholder"
                        [min]="field.validation?.min || null"
                        [max]="field.validation?.max || null"
                        [readonly]="!isFieldEditable(field)"
                        [class.readonly-field]="!isFieldEditable(field)"
                        class="form-input"
                      />
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>

                    <!-- Textarea Input -->
                    <div *ngSwitchCase="'textarea'" class="form-field">
                      <label [for]="field.fieldId" class="field-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                        <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                      </label>
                      <textarea
                        [id]="field.fieldId"
                        [formControlName]="field.fieldId"
                        [placeholder]="field.placeholder"
                        [readonly]="!isFieldEditable(field)"
                        [class.readonly-field]="!isFieldEditable(field)"
                        class="form-textarea"
                        rows="3"
                      ></textarea>
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>

                    <!-- Group Field with SubFields -->
                    <div *ngSwitchCase="'group'" class="form-field field-group">
                      <div class="group-header">
                        <label class="field-label group-label">
                          {{ field.uiDisplayName }}
                          <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        </label>
                        <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                      </div>
                      <div class="group-fields">
                        <ng-container *ngFor="let subField of field.subFields">
                          <div class="subfield-container" [class]="'grid-' + (subField.gridSize || 3)">
                            <ng-container [ngSwitch]="subField.fieldType">
                              <!-- SubField Text Input -->
                              <div *ngSwitchCase="'text'" class="form-field">
                                <label [for]="subField.fieldId" class="field-label">
                                  {{ subField.uiDisplayName }}
                                  <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                                </label>
                                <input
                                  [id]="subField.fieldId"
                                  type="text"
                                  [formControlName]="subField.fieldId"
                                  [placeholder]="subField.placeholder"
                                  [readonly]="!isFieldEditable(subField)"
                                  class="form-input"
                                />
                              </div>

                              <!-- SubField Number Input -->
                              <div *ngSwitchCase="'number'" class="form-field">
                                <label [for]="subField.fieldId" class="field-label">
                                  {{ subField.uiDisplayName }}
                                  <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                                </label>
                                <input
                                  [id]="subField.fieldId"
                                  type="number"
                                  [formControlName]="subField.fieldId"
                                  [placeholder]="subField.placeholder"
                                  [readonly]="!isFieldEditable(subField)"
                                  class="form-input"
                                />
                              </div>

                              <!-- SubField Select -->
                              <div *ngSwitchCase="'select'" class="form-field">
                                <label [for]="subField.fieldId" class="field-label">
                                  {{ subField.uiDisplayName }}
                                  <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                                </label>
                                <select 
                                  [id]="subField.fieldId"
                                  [formControlName]="subField.fieldId"
                                  [disabled]="!isFieldEditable(subField)"
                                  class="form-select">
                                  <option value="" hidden>{{ subField.placeholder || 'Select option' }}</option>
                                  <option *ngFor="let option of subField.options" [value]="option.value">
                                    {{ option.label }}
                                  </option>
                                </select>
                              </div>

                              <!-- SubField Textarea -->
                              <div *ngSwitchCase="'textarea'" class="form-field">
                                <label [for]="subField.fieldId" class="field-label">
                                  {{ subField.uiDisplayName }}
                                  <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                                </label>
                                <textarea
                                  [id]="subField.fieldId"
                                  [formControlName]="subField.fieldId"
                                  [placeholder]="subField.placeholder"
                                  [readonly]="!isFieldEditable(subField)"
                                  class="form-textarea"
                                  rows="2"
                                ></textarea>
                              </div>

                              <!-- SubField Default -->
                              <div *ngSwitchDefault class="form-field">
                                <label [for]="subField.fieldId" class="field-label">
                                  {{ subField.uiDisplayName }}
                                  <span class="required-indicator" *ngIf="subField.isRequired">*</span>
                                </label>
                                <input
                                  [id]="subField.fieldId"
                                  type="text"
                                  [formControlName]="subField.fieldId"
                                  [placeholder]="subField.placeholder"
                                  [readonly]="!isFieldEditable(subField)"
                                  class="form-input"
                                />
                              </div>
                            </ng-container>
                          </div>
                        </ng-container>
                      </div>
                    </div>

                    <!-- Select Input -->
                    <div *ngSwitchCase="'select'" class="form-field">
                      <label [for]="field.fieldId" class="field-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                        <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                      </label>
                      <select 
                        [id]="field.fieldId"
                        [formControlName]="field.fieldId"
                        [disabled]="!isFieldEditable(field)"
                        class="form-select">
                        <option value="" hidden>{{ field.placeholder || 'Select option' }}</option>
                        <option *ngFor="let option of field.options" [value]="option.value">
                          {{ option.label }}
                        </option>
                      </select>
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>

                    <!-- Default case for other field types -->
                    <div *ngSwitchDefault class="form-field">
                      <label [for]="field.fieldId" class="field-label">
                        {{ field.uiDisplayName }}
                        <span class="required-indicator" *ngIf="field.isRequired">*</span>
                        <span *ngIf="isFieldEditable(field)" class="editable-indicator">‚úèÔ∏è</span>
                        <span *ngIf="!isFieldEditable(field)" class="readonly-indicator">üìñ</span>
                      </label>
                      <input
                        [id]="field.fieldId"
                        type="text"
                        [formControlName]="field.fieldId"
                        [placeholder]="field.placeholder"
                        [readonly]="!isFieldEditable(field)"
                        [class.readonly-field]="!isFieldEditable(field)"
                        class="form-input"
                      />
                      <div class="field-help" *ngIf="field.helpText">{{ field.helpText }}</div>
                    </div>
                  </ng-container>
                    </div>
                  </div>
                </div>
              </div>

              <!-- End of tab -->
            </div>
          </ng-container>
        </div>
      </div>
    </form>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="goBack()">Cancel</button>
      <button type="button" class="btn btn-warning" (click)="clearAllFields()" [disabled]="getFilledFieldsCount() === 0">
        üóëÔ∏è Clear All Fields ({{ getFilledFieldsCount() }})
      </button>
      <button type="button" class="btn btn-info" (click)="devLogin()">üîê Dev Login</button>
      <button type="button" class="btn btn-warning" (click)="testAuth()">üß™ Test Auth</button>
      <button type="button" class="btn btn-primary" (click)="onSubmit()" [disabled]="isSaving() || !mainForm.get('templateName')?.value || mainForm.get('templateName')?.value.trim().length < 3">
        <span *ngIf="isSaving()">Saving...</span>
        <span *ngIf="!isSaving()">{{ isEditMode() ? 'Update' : 'Create' }} Template</span>
      </button>
    </div>
  </div>
</div>

<!-- Confirmation Modal -->
<app-confirmation-modal
  [isVisible]="showConfirmationModal()"
  [data]="confirmationModalData()"
  (confirmed)="onClearConfirmed()"
  (cancelled)="onClearCancelled()">
</app-confirmation-modal>
