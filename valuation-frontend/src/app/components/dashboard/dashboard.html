<div class="dashboard-container">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="header-content">
      <div class="welcome-section">
        <h1 class="dashboard-title">Dashboard</h1>
        <p class="company-info">{{ getCurrentOrgName() }}</p>
        <span *ngIf="isUserSystemAdmin" class="admin-badge">System Admin</span>
      </div>
      
      <!-- Organization Switcher for Admins -->
      <div class="org-switcher-container" *ngIf="isUserSystemAdmin">
        <button (click)="toggleOrgSwitcher()" class="org-switcher-btn">
          <span class="switch-icon">üîÑ</span>
          Switch Organization
        </button>
        
        <!-- Dropdown for org selection -->
        <div class="org-dropdown" *ngIf="showOrgSwitcher">
          <div class="dropdown-header">
            <h4>Switch to Organization:</h4>
            <button (click)="toggleOrgSwitcher()" class="close-btn">√ó</button>
          </div>
          <div class="org-list">
            <div 
              *ngFor="let org of availableOrgs" 
              class="org-item"
              [class.selected]="selectedOrgForSwitch === org.org_short_name"
              (click)="selectedOrgForSwitch = org.org_short_name">
              <span class="org-name">{{ getOrgDisplayName(org) }}</span>
              <span class="org-type">{{ getOrgSubscriptionPlan(org) }}</span>
            </div>
          </div>
          <div class="dropdown-actions">
            <button 
              (click)="switchToOrganization()" 
              [disabled]="!selectedOrgForSwitch"
              class="switch-btn">
              Switch Now
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Action Section -->
  <div class="quick-actions">
    <button class="create-report-btn" (click)="createNewReport()">
      ‚ûï Create New Report
    </button>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid">
    <!-- Pending Reports Card -->
    <div class="stats-card pending-card" (click)="navigateToReports()">
      <div class="card-header">
        <div class="card-icon pending-icon">
          ‚è∞
        </div>
        <div class="card-title">Pending Reports</div>
      </div>
      <div class="card-content">
        <div class="card-number">{{ getDisplayStats().pendingReports }}</div>
        <div class="card-subtitle">
          {{ getCurrentOrgName() }}
        </div>
      </div>
      <div class="card-footer">
        <span class="view-all">View All ‚Üí</span>
      </div>
    </div>

    <!-- Created Reports Card -->
    <div class="stats-card created-card" (click)="navigateToReports()">
      <div class="card-header">
        <div class="card-icon created-icon">
          üìÑ
        </div>
        <div class="card-title">Created Reports</div>
      </div>
      <div class="card-content">
        <div class="card-number">{{ getDisplayStats().createdReports }}</div>
        <div class="card-subtitle">
          Organization Reports
        </div>
      </div>
      <div class="card-footer">
        <span class="view-all">View All ‚Üí</span>
      </div>
    </div>

    <!-- Banks Card -->
    <div class="stats-card banks-card" (click)="navigateToBanks()">
      <div class="card-header">
        <div class="card-icon banks-icon">
          üè¶
        </div>
        <div class="card-title">Banks</div>
      </div>
      <div class="card-content">
        <div class="card-number">{{ getDisplayStats().totalBanks }}</div>
        <div class="card-subtitle">
          Available Banks
        </div>
      </div>
      <div class="card-footer">
        <span class="view-all">View All ‚Üí</span>
      </div>
    </div>

    <!-- Templates Card (Manager/Admin Only) -->
    <div class="stats-card templates-card" *ngIf="isSystemAdmin" (click)="navigateToTemplates()">
      <div class="card-header">
        <div class="card-icon templates-icon">
          üìã
        </div>
        <div class="card-title">Templates</div>
      </div>
      <div class="card-content">
        <div class="card-number">Custom</div>
        <div class="card-subtitle">
          Manage report templates
        </div>
      </div>
      <div class="card-footer">
        <span class="view-all">Manage ‚Üí</span>
      </div>
    </div>

    <!-- Companies Card (Admin Only) -->
    <div class="stats-card companies-card" *ngIf="isSystemAdmin">
      <div class="card-header">
        <div class="card-icon companies-icon">
          üè¢
        </div>
        <div class="card-title">Companies</div>
      </div>
      <div class="card-content">
        <div class="card-number">{{ collectiveStats.totalCompanies }}</div>
        <div class="card-subtitle">Active companies</div>
      </div>
      <div class="card-footer">
        <span class="view-all">Manage ‚Üí</span>
      </div>
    </div>
  </div>

  <!-- Recent Activity Section -->
  <div class="recent-activity">
    <div class="activity-header">
      <h2 class="activity-title">Recent Activity</h2>
      <p class="activity-subtitle">Last 5 business days</p>
    </div>
    
    <div class="activity-list">
      <div class="activity-item" *ngFor="let activity of recentActivity">
        <div class="activity-date">{{ activity.date }}</div>
        <div class="activity-content">
          <div class="activity-type" [class]="activity.type">
            {{ activity.count }} {{ activity.type === 'created' ? 'reports created' : 'reports pending' }}
          </div>
          <div class="activity-company" *ngIf="isSystemAdmin">
            {{ activity.company }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
